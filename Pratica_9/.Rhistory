options(encoding = "UTF-8")
#limpar a memória
rm(list = ls())
library(readxl)
library(ggplot2)
dados <- read_excel("dados.xlsx", sheet = "AtividadeEx1")
head(dados)
attach(dados)
summary(dados)
ggplot(dados, aes(x = Tempo, y = Sangue)) +
geom_point(color = "darkred") +
labs(title = "Tempo de Serviço vs. Dióxido de Carbono no Sangue",
x = "Tempo de Serviço",
y = "Nível de CO2 no Sangue") +
theme_minimal()
cor.test(Tempo, Sangue)
qt(0.975, 68)
# Regressão Linear Simples
# variável dependente: dióxido de carbono no sangue
# variavel independete: tempo
# lm: linear model
modelo <- lm(Sangue ~ Tempo) # ajuste da reta de regressão de teste de hipóteses
summary(modelo)
# Calculo do IC
confint(modelo)
# Gráfico da Regressão
ggplot(dados, aes(x = Tempo, y = Sangue)) +
geom_point() +
geom_smooth(method = "lm", col = "blue") +
labs(title = "Regressão Linear Simples entre Nível de Colesterol no Sangue  \n e Tempo de Serviço",
x = "Nível de Colesterol",
y = "Tempo de Serviço") +
annotate("text", x=50, y=28, label = "y=22.99+0.04x,
F=599.8, p-value<0.001,
R² = 90.49%")+
theme_minimal()
summary(aov(modelo))
(R2 <- (58.74/64.91 )*100)
# analise de resíduos
residuos <- modelo$residuals
shapiro.test(residuos)
anova<- aov(modelo)
plot(anova, 1) # avalia os valores ajustados com os resíduos
plot(anova, 2) # avalia os resíduos
dados[c(17,35,61),]
dadosATV2 <- read_excel("dados.xlsx", sheet = "AtividadeEx2")
head(dadosATV2)
attach(dadosATV2)
Sobrevida <- `Tempo de sobrevida em meses` # mudando a variável
summary(dadosATV2)
ggplot(dadosATV2, aes(x = Estadiamento, y = Sobrevida)) +
geom_boxplot(fill = "skyblue", color = "black") +
geom_jitter(width = 0.1, alpha = 0.6, color = "darkblue") +
labs(title = "Tempo de Sobrevida por Estadiamento do Câncer",
x = "Estadiamento da Doença",
y = "Tempo de Sobrevida (meses)") +
theme_minimal()
# Teste de normalidade dentro de cada estadiamento
by(dadosATV2$`Tempo de sobrevida em meses`, dadosATV2$Estadiamento, shapiro.test)
kruskal.test(`Tempo de sobrevida em meses` ~ Estadiamento, data = dadosATV2)
library(pgirmess)
library(pgirmess)
install.packages("e1071")
library(pgirmess)
library(pgirmess)
kruskalmc(Sobrevida~Estadiamento)
(tapply(Sobrevida, Estadiamento, median))
